{% load static %}
<nav class="fixed top-0 left-0 z-50 w-full border-b border-gray-200 bg-white shadow-sm">
  <div class="max-w-8xl mx-auto px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between">
      <div class="flex items-center">
        <div class="mx-auto mr-4 h-10 w-10">
          <img src="{% static 'image/logo_navbar.png' %}" class="h-full w-full object-contain" onclick="window.location.href='/'" />
        </div>
        <h1 class="text-xl font-semibold text-gray-900">
          <a href="/" class="text-green-600">Kickoff Standoff</a>
        </h1>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden items-center space-x-8 md:flex">

            <div class="relative inline-block text-left">  <!-- Make sure this has 'relative' -->
    <span id="categoryBtn" class="text-gray-700 hover:text-blue-600 cursor-pointer">
        Categories
        <svg class="w-4 h-4 inline ml-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
        </svg>
    </span>

    <!-- Left-aligned dropdown -->
    <div id="categoryMenu" class="hidden absolute left-0 top-full mt-0 pt-2 w-56 bg-white rounded-md shadow-lg border border-gray-200 z-10">
        <a href="?" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">All Products</a>
        {% for category in categories %}
            <a href="?filter={{ category }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">{{ category }}</a>
        {% endfor %}
    </div>

    </div>





      </div>

      <!-- Desktop User Section -->
      <div class="hidden items-center space-x-6 md:flex">
        {% if user.is_authenticated %}
        <div class="text-right">
          <div class="text-sm font-medium text-gray-900">{{ name|default:user.username }}</div>
          <div class="text-xs text-gray-500">{{ npm|default:"Student" }} - {{ class|default:"Class" }}</div>
        </div>
        <a href="{% url 'main:logout' %}" class="font-medium text-red-600 transition-colors hover:text-red-700"> Logout </a>
        {% else %}
        <a href="{% url 'main:login' %}" class="font-medium text-gray-600 transition-colors hover:text-gray-900"> Login </a>
        <a href="{% url 'main:register' %}" class="rounded bg-green-600 px-4 py-2 font-medium text-white transition-colors hover:bg-green-700"> Register </a>
        {% endif %}
      </div>

      <!-- Mobile Menu Button -->
      <div class="flex items-center md:hidden">
        <button class="mobile-menu-button p-2 text-gray-600 transition-colors hover:text-gray-900">
          <span class="sr-only">Open menu</span>
          <div class="flex h-6 w-6 flex-col items-center justify-center">
            <span class="block h-0.5 w-6 rounded-sm bg-current transition-all duration-300 ease-out"></span>
            <span class="my-0.5 block h-0.5 w-6 rounded-sm bg-current transition-all duration-300 ease-out"></span>
            <span class="block h-0.5 w-6 rounded-sm bg-current transition-all duration-300 ease-out"></span>
          </div>
        </button>
      </div>
    </div>
  </div>
  <!-- Mobile Menu -->
  <div class="mobile-menu hidden border-t border-gray-200 bg-white md:hidden">
    <div class="space-y-4 px-6 py-4">
      <!-- Mobile Navigation Links -->
      <div class="space-y-1">
        <a href="/" class="block py-3 font-medium text-gray-600 transition-colors hover:text-gray-900"> Home </a>
        <a href="{% url 'main:add_product' %}" class="block py-3 font-medium text-gray-600 transition-colors hover:text-gray-900"> Create News </a>
      </div>

      <!-- Mobile User Section -->
      <div class="border-t border-gray-200 pt-4">
        {% if user.is_authenticated %}
        <div class="mb-4">
          <div class="font-medium text-gray-900">{{ name|default:user.username }}</div>
          <div class="text-sm text-gray-500">{{ npm|default:"Student" }} - {{ class|default:"Class" }}</div>
        </div>
        <a href="{% url 'main:logout' %}" class="block py-3 font-medium text-red-600 transition-colors hover:text-red-700"> Logout </a>
        {% else %}
        <div class="space-y-3">
          <a href="{% url 'main:login' %}" class="block py-3 font-medium text-gray-600 transition-colors hover:text-gray-900"> Login </a>
          <a href="{% url 'main:register' %}" class="block rounded bg-green-600 px-4 py-3 text-center font-medium text-white transition-colors hover:bg-green-700"> Register </a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  <script>
    const btn = document.querySelector("button.mobile-menu-button");
    const menu = document.querySelector(".mobile-menu");

    btn.addEventListener("click", () => {
      menu.classList.toggle("hidden");
    });


  function initDropdown(btnId, menuId) {
    const btn = document.getElementById(btnId);
    const menu = document.getElementById(menuId);
    let isClicked = false;

    // Show on hover
    btn.addEventListener('mouseenter', () => menu.classList.remove('hidden'));

    // Keep open on click
    btn.addEventListener('click', (e) => {
        e.stopPropagation();
        isClicked = true;
        menu.classList.remove('hidden');
    });

    // hide when not hovered
    const container = btn.parentElement;
    container.addEventListener('mouseleave', () => {
        if (!isClicked) {
            menu.classList.add('hidden');
        }
    });

    // Close when clicking outside
    document.addEventListener('click', () => {
        menu.classList.add('hidden');
        isClicked = false;
    });

    // Prevent closing when clicking inside menu
    menu.addEventListener('click', (e) => e.stopPropagation());
  }
  initDropdown('categoryBtn', 'categoryMenu')
  </script>
</nav>
